<div id="container">
    <form [formGroup]="passwordForm" novalidate (ngSubmit)="updatePassword()" id="form-container">
        <div class="input-container">
            <div id="title">Cambiar contraseña</div>
        </div>

        <div class="input-container">
            <mat-form-field appearance="outline">
                <mat-label>Contraseña actual</mat-label>
                <input matInput [type]="hideCurrentPassword ? 'password' : 'text'" formControlName="currentPassword" />
                <button mat-icon-button type="button" matSuffix (click)="hideCurrentPassword = !hideCurrentPassword"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideCurrentPassword">
                    <mat-icon>{{ hideCurrentPassword ? "visibility_off" : "visibility" }}</mat-icon>
                </button>
            </mat-form-field>
            <div *ngIf="passwordForm.get('currentPassword')?.hasError('required') && passwordForm.get('currentPassword')?.touched"
                class="error-message">
                Contraseña actual es requerida.
            </div>
        </div>

        <div class="input-container">
            <mat-form-field appearance="outline">
                <mat-label>Nueva contraseña</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="newPassword" />
                <button mat-icon-button type="button" matSuffix (click)="hidePassword = !hidePassword"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePassword">
                    <mat-icon>{{ hidePassword ? "visibility_off" : "visibility" }}</mat-icon>
                </button>
            </mat-form-field>
            <div *ngIf="passwordForm.get('newPassword')?.hasError('required') && passwordForm.get('newPassword')?.touched"
                class="error-message">
                Nueva contraseña es requerida.
            </div>
            <div *ngIf="passwordForm.get('newPassword')?.hasError('minlength') && passwordForm.get('newPassword')?.touched"
                class="error-message">
                La contraseña debe tener al menos 6 caracteres.
            </div>
        </div>

        <div class="input-container">
            <mat-form-field appearance="outline">
                <mat-label>Confirmar contraseña</mat-label>
                <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword" />
                <button mat-icon-button type="button" matSuffix (click)="hideConfirmPassword = !hideConfirmPassword"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideConfirmPassword">
                    <mat-icon>{{ hideConfirmPassword ? "visibility_off" : "visibility" }}</mat-icon>
                </button>
            </mat-form-field>
            <div *ngIf="passwordForm.get('confirmPassword')?.hasError('required') && passwordForm.get('confirmPassword')?.touched"
                class="error-message">
                Contraseña es requerida.
            </div>
            <div *ngIf="passwordForm.get('confirmPassword')?.hasError('minlength') && passwordForm.get('confirmPassword')?.touched"
                class="error-message">
                La contraseña debe tener al menos 6 caracteres.
            </div>
            <div *ngIf="passwordForm.hasError('passwordsNotMatching') && passwordForm.get('confirmPassword')?.touched"
                class="error-message">
                Las contraseñas no son iguales
            </div>
        </div>

        <div id="button-container">
            <button 
            mat-raised-button 
            class="enabled-button" 
            type="submit" 
            [disabled]="!passwordForm.valid" 
            [ngClass]="{
            'enabled-button': passwordForm.valid,
            'disabled-button': !passwordForm.valid
            }">
                Guardar
            </button>
            <button 
            mat-raised-button 
            type="button" 
            class="cancel-button" 
            [routerLink]="['/user']">
            Regresar
        </button>
        </div>
    </form>
</div>
